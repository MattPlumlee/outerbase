<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="outerbase">
<title>Base walkthrough â€¢ outerbase</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Source%20Sans%20Pro-0.4.1/font.css" rel="stylesheet">
<link href="../deps/_Source%20Code%20Pro-0.4.1/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Base walkthrough">
<meta property="og:description" content="outerbase">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">outerbase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/gettingstarted.html">Get Started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-elements">Elements</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-elements">
    <a class="dropdown-item" href="../articles/basebasics.html">Models and Bases</a>
    <a class="dropdown-item" href="../articles/learning.html">Learning</a>
    <a class="dropdown-item" href="../articles/speed.html">Speed</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Versions</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MattPlumlee/outerbase/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Base walkthrough</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MattPlumlee/outerbase/blob/HEAD/vignettes/basebasics.Rmd" class="external-link"><code>vignettes/basebasics.Rmd</code></a></small>
      <div class="d-none name"><code>basebasics.Rmd</code></div>
    </div>

    
    
<p>This page is designed to explain <code><a href="../reference/outermod.html">?outermod</a></code> and <code><a href="../reference/outerbase.html">?outerbase</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mattplumlee.github.io/outerbase/">outerbase</a></span><span class="op">)</span></code></pre></div>
<p>A three dimensional case study is sufficient for understanding what <code>outermod</code> and <code>outerbase</code> are and how to manipulate them.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sampsize</span> <span class="op">=</span> <span class="fl">30</span>
<span class="va">d</span> <span class="op">=</span> <span class="fl">3</span>
<span class="va">design1d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">sampsize</span><span class="op">)</span>,<span class="fl">1</span><span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">sampsize</span><span class="op">)</span>,<span class="fl">1</span><span class="op">/</span><span class="va">sampsize</span><span class="op">)</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">design1d</span>,<span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">design1d</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">design1d</span><span class="op">)</span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="../reference/obtest_borehole3d.html">obtest_borehole3d</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="covariance-functions">Covariance functions<a class="anchor" aria-label="anchor" href="#covariance-functions"></a>
</h2>
<p>Covariance functions are an important building block of Gaussian process inference. This package uses a custom class to represent covariance function. See <code><a href="../reference/covf.html">?covf</a></code> for more information on the base class.</p>
<p>Creating instances is done through the <code><a href="https://rdrr.io/r/methods/new.html" class="external-link">?methods::new</a></code> call with the class name listed inside.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">corf</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="va">covf_mat25</span><span class="op">)</span></code></pre></div>
<p>The <code>cov</code> method builds covariances matrices. Below is an example of calling this method. Note that these are designed to be single dimensional covariance functions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xred</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">corf</span><span class="op">$</span><span class="fu">cov</span><span class="op">(</span><span class="va">xred</span>,<span class="va">xred</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]</span>
<span class="co">#&gt; [1,] 1.000 1.000 0.999 0.998 0.997</span>
<span class="co">#&gt; [2,] 1.000 1.000 1.000 0.999 0.998</span>
<span class="co">#&gt; [3,] 0.999 1.000 1.000 1.000 0.999</span>
<span class="co">#&gt; [4,] 0.998 0.999 1.000 1.000 1.000</span>
<span class="co">#&gt; [5,] 0.997 0.998 0.999 1.000 1.000</span></code></pre></div>
<p>Hyperparameters are important for almost all covariance functions. They control the general shape and behavior of the covariance function. They are stored in the <code>covf</code> class in the (editable) field <code>hyp</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">corf</span><span class="op">$</span><span class="va">hyp</span>
<span class="co">#&gt;      [,1]</span>
<span class="co">#&gt; [1,]    0</span></code></pre></div>
<p>You can see the effect of alternating <code>hyp</code> below on this correlation function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">corf</span><span class="op">$</span><span class="va">hyp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">corf</span><span class="op">$</span><span class="fu">cov</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="fl">0.5</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>,
     ylab<span class="op">=</span><span class="st">'correlation with 0.5'</span>, xlab<span class="op">=</span><span class="st">'input'</span><span class="op">)</span>
<span class="va">corf</span><span class="op">$</span><span class="va">hyp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">corf</span><span class="op">$</span><span class="fu">cov</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="fl">0.5</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span>
<span class="va">corf</span><span class="op">$</span><span class="va">hyp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">corf</span><span class="op">$</span><span class="fu">cov</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="fl">0.5</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span></code></pre></div>
<p><img src="basebasics_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="gaussian-processes">Gaussian processes<a class="anchor" aria-label="anchor" href="#gaussian-processes"></a>
</h2>
<p>Gaussian processes have long been shown to be top performers for near interpolation. For more information on general Gaussian processes, see the textbooks <a href="https://gaussianprocess.org/gpml/" class="external-link">Gaussian Processes for Machine Learning</a> or <a href="https://bobby.gramacy.com/surrogates/" class="external-link">Surrogates</a>, among others.</p>
<p>The idea is to represent a surface as a realization of a Gaussian process controlled by a covariance function. An outer product of covariance functions can do this job in three dimensions. This means we need to first build covariance functions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">corf1</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="va">covf_mat25</span><span class="op">)</span>
<span class="va">corf2</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="va">covf_mat25</span><span class="op">)</span>
<span class="va">corf3</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="va">covf_mat25</span><span class="op">)</span>
<span class="va">corf1</span><span class="op">$</span><span class="va">hyp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="co"># just setting them all to the same </span>
<span class="va">corf2</span><span class="op">$</span><span class="va">hyp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="co"># hyperparameter for now</span>
<span class="va">corf3</span><span class="op">$</span><span class="va">hyp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p>And then multiply them to calculate the covariance between two sets of points.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">covftot</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span><span class="op">{</span>
  <span class="va">corf1</span><span class="op">$</span><span class="fu">cov</span><span class="op">(</span><span class="va">x1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">x2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span>
  <span class="va">corf2</span><span class="op">$</span><span class="fu">cov</span><span class="op">(</span><span class="va">x1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">x2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span>
  <span class="va">corf3</span><span class="op">$</span><span class="fu">cov</span><span class="op">(</span><span class="va">x1</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,<span class="va">x2</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">cormattot</span> <span class="op">=</span> <span class="fu">covftot</span><span class="op">(</span><span class="va">x</span>,<span class="va">x</span><span class="op">)</span> <span class="co">#total correlation matrix</span></code></pre></div>
<p>The goal of Gaussian process inference is to take our data and predict at some number of points, say <code>1000</code> points.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">testsampsize</span> <span class="op">=</span> <span class="fl">1000</span>
<span class="va">xtest</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">testsampsize</span><span class="op">*</span><span class="va">d</span><span class="op">)</span>,ncol<span class="op">=</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<p>The predictor follows from typical formulas (assuming y is zero mean, see textbooks).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yhat</span> <span class="op">=</span> <span class="fu">covftot</span><span class="op">(</span><span class="va">xtest</span>,<span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">cormattot</span>,<span class="va">y</span><span class="op">)</span></code></pre></div>
<p>This gives prediction accuracy that can be summarized below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">ytest</span> <span class="op">=</span> <span class="fu"><a href="../reference/obtest_borehole3d.html">obtest_borehole3d</a></span><span class="op">(</span><span class="va">xtest</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">ytest</span>, ylab<span class="op">=</span><span class="st">"actual"</span>, xlab<span class="op">=</span><span class="st">"prediction"</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ytest</span><span class="op">-</span><span class="va">yhat</span>, main<span class="op">=</span><span class="st">"test residuals"</span>,
     xlab <span class="op">=</span> <span class="st">"test residuals"</span><span class="op">)</span></code></pre></div>
<p><img src="basebasics_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>We can also use this framework to get predictive variances. These equations will not be explained in this documentation for brevity. One point here is that is does pretty well! The plot below looks standard Normal enough.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sigma2hat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">cormattot</span>,<span class="va">y</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>

<span class="va">varpred</span> <span class="op">=</span> <span class="va">sigma2hat</span><span class="op">*</span><span class="op">(</span><span class="fu">covftot</span><span class="op">(</span><span class="va">xtest</span>,<span class="va">xtest</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">covftot</span><span class="op">(</span><span class="va">x</span>,<span class="va">xtest</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">cormattot</span>,<span class="fu">covftot</span><span class="op">(</span><span class="va">x</span>,<span class="va">xtest</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="op">(</span><span class="va">ytest</span><span class="op">-</span><span class="va">yhat</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">varpred</span><span class="op">)</span><span class="op">)</span>,
     main<span class="op">=</span><span class="st">"standarized test residuals"</span>,
     xlab <span class="op">=</span> <span class="st">"standarized test residuals"</span><span class="op">)</span></code></pre></div>
<p><img src="basebasics_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>The main complaints about Gaussian process inference are stability and computation speed. This package is designed to reduce those concerns.</p>
</div>
<div class="section level2">
<h2 id="outermod-and-outerbase">outermod and outerbase<a class="anchor" aria-label="anchor" href="#outermod-and-outerbase"></a>
</h2>
<p>The core classes in this package are <code><a href="../reference/outermod.html">?outermod</a></code> and <code><a href="../reference/outerbase.html">?outerbase</a></code>. An <code>outermod</code> instance contains all the information to build an <code>outerbase</code> instance, but does not build the objects corresponding to a specific <code>x</code>. An <code>outerbase</code> instance is used build inference at a specific <code>x</code>.</p>
<div class="section level3">
<h3 id="outermod">outermod<a class="anchor" aria-label="anchor" href="#outermod"></a>
</h3>
<p>An instance of the class <code>outermod</code> is designed to hold the information needed to create a basis matrix. An <code>outermod</code> instance is created using <code>new</code> command.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">om</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="va">outermod</span><span class="op">)</span></code></pre></div>
<p>The first step is to set the covariance functions and the knots. To set the vector of <code>covfs</code>, use <code><a href="../reference/setcovfs.html">?setcovfs</a></code> alongside a vector strings of covariance functions in the package (<code><a href="../reference/listcov.html">?listcov</a></code>).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setcovfs.html">setcovfs</a></span><span class="op">(</span><span class="va">om</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"mat25"</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>This fixes the dimension of the <code>outermod</code> instance <code>om</code> to <code>3</code>.</p>
<p>Then we need to give it a set of knot points for each dimension. The choice of these is still being researched, but choosing points that are spread out in each dimension that look like our actual data is currently recommended. You will need to invert a matrix of the size of these knot points, so it is recommended to keep it small, <code>&lt;50</code> in general. The function <code><a href="../reference/setknot.html">?setknot</a></code> should be used.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">knotlist</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.025</span><span class="op">)</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.025</span><span class="op">)</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/setknot.html">setknot</a></span><span class="op">(</span><span class="va">om</span>, <span class="va">knotlist</span><span class="op">)</span></code></pre></div>
<p>The hyperparameters can be set directly through our <code>outermod</code> object.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gethyp.html">gethyp</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span>
<span class="co">#&gt; inpt1.scale inpt2.scale inpt3.scale </span>
<span class="co">#&gt;           0           0           0</span>
<span class="va">om</span><span class="op">$</span><span class="fu">updatehyp</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/gethyp.html">gethyp</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span>
<span class="co">#&gt; inpt1.scale inpt2.scale inpt3.scale </span>
<span class="co">#&gt;        -0.5        -0.5        -0.5</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="outerbase">outerbase<a class="anchor" aria-label="anchor" href="#outerbase"></a>
</h3>
<p>An instance of the class <code>outerbase</code> is the equivalent of a basis matrix with fast computation methods included. It is also created with <code>new</code>, but it also requires a reference to an <code>outermod</code> instance and a specific set of prediction points <code>x</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ob</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="va">outerbase</span>, 
         <span class="va">om</span>, <span class="co"># an outermod (reference only)</span>
          <span class="va">x</span><span class="op">)</span> <span class="co"># an input matrix</span></code></pre></div>
<p>This builds a set of basis functions for each dimension, which sometimes just look like polynomials. They are not quite polynomials, and some covariance functions give different shapes. The call <code>outerbase$getbase</code> will allow you to access the basis functions for each dimension. This is mostly useful for plotting.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">basis_func</span> <span class="op">=</span> <span class="va">ob</span><span class="op">$</span><span class="fu">getbase</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">basis_func</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, 
        type<span class="op">=</span><span class="st">'l'</span>, ylab<span class="op">=</span><span class="st">"func"</span>, xlab<span class="op">=</span><span class="st">"first dim"</span><span class="op">)</span></code></pre></div>
<p><img src="basebasics_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="outermod-and-outerbase-1">outermod and outerbase<a class="anchor" aria-label="anchor" href="#outermod-and-outerbase-1"></a>
</h3>
<p><code>outermod</code> and <code>outerbase</code> are meant to be used in conjunction with each other. One key ingredient is the <code>outermod$selectterms</code> function, which allows you to pick products of basis functions that best represent the current <code>outermod</code> response.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">=</span> <span class="fl">60</span>
<span class="va">terms</span> <span class="op">=</span> <span class="va">om</span><span class="op">$</span><span class="fu">selectterms</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="co"># 60 by 3 matrix</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">terms</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]    0    0    0</span>
<span class="co">#&gt; [2,]    1    0    0</span>
<span class="co">#&gt; [3,]    0    0    1</span>
<span class="co">#&gt; [4,]    0    1    0</span>
<span class="co">#&gt; [5,]    1    1    0</span>
<span class="co">#&gt; [6,]    1    0    1</span></code></pre></div>
<p><code>outermod$getvar</code> returns the vector of variances associated with these coefficients at these <code>terms</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">covcoeff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">om</span><span class="op">$</span><span class="fu">getvar</span><span class="op">(</span><span class="va">terms</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The specific basis matrix can be formed by getting the basis matrix at these selected <code>terms</code>. <code>outerbase$getmat</code> will give a short cut to building this matrix.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">basismat</span> <span class="op">=</span> <span class="va">ob</span><span class="op">$</span><span class="fu">getmat</span><span class="op">(</span><span class="va">terms</span><span class="op">)</span>

<span class="va">termno</span> <span class="op">=</span> <span class="fl">5</span>
<span class="va">basevec</span> <span class="op">=</span> <span class="va">ob</span><span class="op">$</span><span class="fu">getbase</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">[</span>,<span class="va">terms</span><span class="op">[</span><span class="va">termno</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span>
  <span class="va">ob</span><span class="op">$</span><span class="fu">getbase</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span>,<span class="va">terms</span><span class="op">[</span><span class="va">termno</span>,<span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span>
  <span class="va">ob</span><span class="op">$</span><span class="fu">getbase</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">[</span>,<span class="va">terms</span><span class="op">[</span><span class="va">termno</span>,<span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">basevec</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,<span class="va">basismat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span> <span class="co"># expect equal</span>
<span class="co">#&gt;            [,1]       [,2]</span>
<span class="co">#&gt; [1,]  0.2667642  0.2667642</span>
<span class="co">#&gt; [2,] -1.3287883 -1.3287883</span>
<span class="co">#&gt; [3,]  2.0756653  2.0756653</span>
<span class="co">#&gt; [4,]  0.9756641  0.9756641</span>
<span class="co">#&gt; [5,] -1.6229195 -1.6229195</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="feature-space-approximation">Feature space approximation<a class="anchor" aria-label="anchor" href="#feature-space-approximation"></a>
</h2>
<p>This package leverages the insight that Gaussian processes are no more than linear combinations of basis functions with random coefficients. This viewpoint is often called the <em>feature space</em> view of Gaussian processes.</p>
<p>To see this, not that if you take the <code>covcoeff</code> and <code>basismat</code> together, the correlation function is very well approximated through the following manipulation.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cormatob</span> <span class="op">=</span> <span class="va">basismat</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">covcoeff</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">basismat</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cormattot</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># typical gp</span>
<span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]</span>
<span class="co">#&gt; [1,] 1.000 0.871 0.744 0.871 0.352</span>
<span class="co">#&gt; [2,] 0.871 1.000 0.580 0.791 0.554</span>
<span class="co">#&gt; [3,] 0.744 0.580 1.000 0.899 0.296</span>
<span class="co">#&gt; [4,] 0.871 0.791 0.899 1.000 0.456</span>
<span class="co">#&gt; [5,] 0.352 0.554 0.296 0.456 1.000</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cormatob</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># outerbase</span>
<span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]</span>
<span class="co">#&gt; [1,] 0.999 0.871 0.744 0.871 0.352</span>
<span class="co">#&gt; [2,] 0.871 1.000 0.580 0.791 0.554</span>
<span class="co">#&gt; [3,] 0.744 0.580 1.000 0.899 0.296</span>
<span class="co">#&gt; [4,] 0.871 0.791 0.899 1.000 0.456</span>
<span class="co">#&gt; [5,] 0.352 0.554 0.296 0.456 1.000</span></code></pre></div>
<p>They means that we can leverage <a href="https://en.wikipedia.org/wiki/Bayesian_linear_regression" class="external-link">Bayesian linear regression</a> to do prediction. This will require assuming that there is some <code>noisevar</code>, which is also called the nugget in the Gaussian process literature.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">noisevar</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span>
<span class="co">#posterior precision matrix of coefficients</span>
<span class="va">postcov</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">noisevar</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">basismat</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">basismat</span><span class="op">+</span> 
                  <span class="fl">1</span><span class="op">/</span><span class="va">sigma2hat</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">covcoeff</span><span class="op">)</span><span class="op">)</span>
<span class="co">#posterior mean of coefficients</span>
<span class="va">coeffest</span> <span class="op">=</span> <span class="va">postcov</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">noisevar</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">basismat</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">y</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="predictions-and-comparison">Predictions and comparison<a class="anchor" aria-label="anchor" href="#predictions-and-comparison"></a>
</h2>
<p>Consider predicting at some new <code>xtest</code> to examine if the inference works the same between the traditional Gaussian process and the feature space approximation.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">obtest</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="va">outerbase</span>, 
         <span class="va">om</span>,     <span class="co"># same outermod </span>
          <span class="va">xtest</span><span class="op">)</span> <span class="co"># new input matrix</span>

<span class="va">basistest</span> <span class="op">=</span> <span class="va">obtest</span><span class="op">$</span><span class="fu">getmat</span><span class="op">(</span><span class="va">terms</span><span class="op">)</span></code></pre></div>
<p>The predictions are nearly equivalent.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yhatob</span> <span class="op">=</span> <span class="va">basistest</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">coeffest</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">ytest</span>, main<span class="op">=</span><span class="st">"typical gp"</span>,
     xlab<span class="op">=</span><span class="st">"prediction"</span>, ylab<span class="op">=</span><span class="st">"actual"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">yhatob</span>, <span class="va">ytest</span>, main <span class="op">=</span> <span class="st">"outerbase equiv."</span>,
     xlab<span class="op">=</span><span class="st">"prediction"</span>, ylab<span class="op">=</span><span class="st">"actual"</span><span class="op">)</span></code></pre></div>
<p><img src="basebasics_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>The histograms of residuals show similar matching.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ytest</span><span class="op">-</span><span class="va">yhat</span>, main<span class="op">=</span><span class="st">"typical gp"</span>,
     xlab<span class="op">=</span><span class="st">"test residuals"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ytest</span><span class="op">-</span><span class="va">yhatob</span>, main<span class="op">=</span><span class="st">"outerbase equiv."</span>,
     xlab<span class="op">=</span><span class="st">"test residuals"</span><span class="op">)</span></code></pre></div>
<p><img src="basebasics_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>The standardized residuals, which account for the variance, also show similar matching.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">varpredob</span> <span class="op">=</span> <span class="va">basistest</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">postcov</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">basistest</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="op">(</span><span class="va">ytest</span><span class="op">-</span><span class="va">yhat</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">varpred</span><span class="op">)</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"typical gp"</span>,
     xlab<span class="op">=</span><span class="st">"standarized test residuals"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="op">(</span><span class="va">ytest</span><span class="op">-</span><span class="va">yhatob</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">varpredob</span><span class="op">)</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"outerbase equiv."</span>,
     xlab<span class="op">=</span><span class="st">"standarized test residuals"</span><span class="op">)</span></code></pre></div>
<p><img src="basebasics_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew Plumlee.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
